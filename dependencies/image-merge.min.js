!function(n,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):n.mergeImages=t()}(this,(function(){"use strict";var n={format:"image/png",quality:.92,width:void 0,height:void 0,Canvas:void 0};return function(t,e){return void 0===t&&(t=[]),void 0===e&&(e={}),new Promise((function(a){var o=(e=Object.assign({},n,e)).Canvas?new e.Canvas:window.document.createElement("canvas"),i=e.Canvas?e.Canvas.Image:window.Image;e.Canvas&&(e.quality*=100);var r=t.map((function(n){return new Promise((function(t,e){"Object"!==n.constructor.name&&(n={src:n});var a=new i;a.onerror=function(){return e(new Error("Couldn't load image"))},a.onload=function(){return t(Object.assign({},n,{img:a}))},a.src=n.src}))})),u=o.getContext("2d");a(Promise.all(r).then((function(n){var t=function(t){return e[t]||Math.max.apply(Math,n.map((function(n){return n.img[t]})))};return o.width=t("width"),o.height=t("height"),n.forEach((function(n){return u.globalAlpha=n.opacity?n.opacity:1,u.drawImage(n.img,n.x||0,n.y||0)})),e.Canvas&&"image/jpeg"===e.format?new Promise((function(n){o.toDataURL(e.format,{quality:e.quality,progressive:!1},(function(t,e){if(t)throw t;n(e)}))})):o.toDataURL(e.format,e.quality)})))}))}}));